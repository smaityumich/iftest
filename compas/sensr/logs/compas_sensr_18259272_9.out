SLURM_JOBID:  18259272
SLURM_ARRAY_TASK_ID:  9
SLURM_ARRAY_JOB_ID:  18259272
2021-03-19 14:27:08.264279: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2021-03-19 14:27:08.264594: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
2021-03-19 14:27:15.375181: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2021-03-19 14:27:15.375217: W tensorflow/stream_executor/cuda/cuda_driver.cc:312] failed call to cuInit: UNKNOWN ERROR (303)
2021-03-19 14:27:15.375239: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3355.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2021-03-19 14:27:15.375541: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-19 14:27:15.384123: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3000000000 Hz
2021-03-19 14:27:15.384219: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559ce0ca0150 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-19 14:27:15.384229: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Running for 51668 64395


(5278, 8)
['sex', 'race', 'priors_count', 'age_cat=25 to 45', 'age_cat=Greater than 45', 'age_cat=Less than 25', 'c_charge_degree=F', 'c_charge_degree=M']
sex
race
Real and fair distances (max/min/mean):
0.0 0.0 0.0
0.0 0.0 0.0
Counter success count is -1
Epoch 0 train accuracy 0.529607; loss 0.705755; lambda is 2.000000
Epoch 0 test accuracy 0.529356
Train AUC is 0.531757; balanced AUC is 0.531757
Train accuracy 0.530; balanced accuracy 0.500; FDR nan; TPR 0.000

Train sex accuracy 0.630; balanced accuracy 0.500; FDR nan; TPR 0.000

Train sex gap RMS 0.0
Train race accuracy 0.608; balanced accuracy 0.500; FDR nan; TPR 0.000

Train race gap RMS 0.0
Train STD accuracy 0.011; balanced accuracy 0.000; FDR nan; TPR 0.000

--------------------------------------------------
Test AUC is 0.549397; balanced AUC is 0.549397
Test accuracy 0.529; balanced accuracy 0.500; FDR nan; TPR 0.000

Test sex accuracy 0.668; balanced accuracy 0.500; FDR nan; TPR 0.000

Test sex gap RMS 0.0
Test race accuracy 0.613; balanced accuracy 0.500; FDR nan; TPR 0.000

Test race gap RMS 0.0
Test STD accuracy 0.028; balanced accuracy 0.000; FDR nan; TPR 0.000

--------------------------------------------------
Real and fair distances (max/min/mean):
4.511962721056328 0.01405366492582873 0.7392601225759413
4.416264e-06 2.7457618e-06 3.7794607e-06
Counter success count is -1
Epoch 1000 train accuracy 0.585504; loss 0.679586; lambda is 0.000010
Epoch 1000 test accuracy 0.583333
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.677282; subspace 0.693489; adv 0.693778
Train AUC is 0.635377; balanced AUC is 0.635377
Train accuracy 0.586; balanced accuracy 0.589; FDR 0.449; TPR 0.647

Train sex accuracy 0.613; balanced accuracy 0.609; FDR 0.519; TPR 0.593

Train sex gap RMS 0.09603566202274974
Train race accuracy 0.578; balanced accuracy 0.580; FDR 0.531; TPR 0.588

Train race gap RMS 0.08080959243607766
Train STD accuracy 0.018; balanced accuracy 0.015; FDR 0.006; TPR 0.003

--------------------------------------------------
Test AUC is 0.644162; balanced AUC is 0.644162
Test accuracy 0.583; balanced accuracy 0.587; FDR 0.451; TPR 0.642

Test sex accuracy 0.664; balanced accuracy 0.659; FDR 0.505; TPR 0.644

Test sex gap RMS 0.13640152717129092
Test race accuracy 0.592; balanced accuracy 0.593; FDR 0.522; TPR 0.599

Test race gap RMS 0.0877204021253334
Test STD accuracy 0.036; balanced accuracy 0.033; FDR 0.008; TPR 0.023

--------------------------------------------------
Real and fair distances (max/min/mean):
3.584995333322366 0.010237557371509526 0.7255221072950665
4.409785e-06 2.5382124e-06 3.7818759e-06
Counter success count is -1
Epoch 2000 train accuracy 0.639507; loss 0.668779; lambda is 0.000010
Epoch 2000 test accuracy 0.635417
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.664062; subspace 0.678638; adv 0.679107
Train AUC is 0.629238; balanced AUC is 0.629238
Train accuracy 0.640; balanced accuracy 0.631; FDR 0.339; TPR 0.479

Train sex accuracy 0.642; balanced accuracy 0.599; FDR 0.480; TPR 0.433

Train sex gap RMS 0.04100256842278767
Train race accuracy 0.651; balanced accuracy 0.596; FDR 0.407; TPR 0.345

Train race gap RMS 0.1647012788159951
Train STD accuracy 0.004; balanced accuracy 0.001; FDR 0.037; TPR 0.044

--------------------------------------------------
Test AUC is 0.633979; balanced AUC is 0.633979
Test accuracy 0.635; balanced accuracy 0.627; FDR 0.345; TPR 0.477

Test sex accuracy 0.636; balanced accuracy 0.583; FDR 0.551; TPR 0.425

Test sex gap RMS 0.05470521938446332
Test race accuracy 0.640; balanced accuracy 0.583; FDR 0.439; TPR 0.329

Test race gap RMS 0.17692696569809685
Test STD accuracy 0.002; balanced accuracy 0.000; FDR 0.056; TPR 0.048

--------------------------------------------------
Real and fair distances (max/min/mean):
3.1713924811155447 0.028610285693993858 0.710677712820999
4.3745963e-06 2.7752944e-06 3.6273552e-06
Counter success count is -1
Epoch 3000 train accuracy 0.644718; loss 0.658951; lambda is 0.000010
Epoch 3000 test accuracy 0.64678
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.660574; subspace 0.675160; adv 0.675861
Train AUC is 0.633322; balanced AUC is 0.633322
Train accuracy 0.645; balanced accuracy 0.635; FDR 0.323; TPR 0.468

Train sex accuracy 0.670; balanced accuracy 0.606; FDR 0.413; TPR 0.360

Train sex gap RMS 0.10053837897891706
Train race accuracy 0.653; balanced accuracy 0.594; FDR 0.394; TPR 0.322

Train race gap RMS 0.17428635000271153
Train STD accuracy 0.009; balanced accuracy 0.006; FDR 0.010; TPR 0.019

--------------------------------------------------
Test AUC is 0.633886; balanced AUC is 0.633886
Test accuracy 0.647; balanced accuracy 0.637; FDR 0.317; TPR 0.465

Test sex accuracy 0.691; balanced accuracy 0.603; FDR 0.444; TPR 0.342

Test sex gap RMS 0.11445605681894894
Test race accuracy 0.659; balanced accuracy 0.595; FDR 0.381; TPR 0.311

Test race gap RMS 0.1885184471326055
Test STD accuracy 0.016; balanced accuracy 0.004; FDR 0.032; TPR 0.016

--------------------------------------------------
Real and fair distances (max/min/mean):
3.4699849282316064 0.016838972394262502 0.6419609318861844
4.3286877e-06 2.500194e-06 3.5658777e-06
Counter success count is -1
Epoch 4000 train accuracy 0.644718; loss 0.651595; lambda is 0.000010
Epoch 4000 test accuracy 0.64678
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.652578; subspace 0.665648; adv 0.666521
Train AUC is 0.667060; balanced AUC is 0.667060
Train accuracy 0.645; balanced accuracy 0.635; FDR 0.323; TPR 0.468

Train sex accuracy 0.670; balanced accuracy 0.606; FDR 0.413; TPR 0.360

Train sex gap RMS 0.10053837897891706
Train race accuracy 0.653; balanced accuracy 0.594; FDR 0.394; TPR 0.322

Train race gap RMS 0.17428635000271153
Train STD accuracy 0.009; balanced accuracy 0.006; FDR 0.010; TPR 0.019

--------------------------------------------------
Test AUC is 0.665798; balanced AUC is 0.665798
Test accuracy 0.647; balanced accuracy 0.637; FDR 0.317; TPR 0.465

Test sex accuracy 0.691; balanced accuracy 0.603; FDR 0.444; TPR 0.342

Test sex gap RMS 0.11445605681894894
Test race accuracy 0.659; balanced accuracy 0.595; FDR 0.381; TPR 0.311

Test race gap RMS 0.1885184471326055
Test STD accuracy 0.016; balanced accuracy 0.004; FDR 0.032; TPR 0.016

--------------------------------------------------
Real and fair distances (max/min/mean):
3.745794330044389 0.023891952092701736 0.5795397998290418
4.3121486e-06 2.3693378e-06 3.6976976e-06
Counter success count is -1
Epoch 5000 train accuracy 0.644718; loss 0.645728; lambda is 0.000010
Epoch 5000 test accuracy 0.64678
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.655252; subspace 0.668485; adv 0.669503
Train AUC is 0.678899; balanced AUC is 0.678899
Train accuracy 0.645; balanced accuracy 0.635; FDR 0.323; TPR 0.468

Train sex accuracy 0.670; balanced accuracy 0.606; FDR 0.413; TPR 0.360

Train sex gap RMS 0.10053837897891706
Train race accuracy 0.653; balanced accuracy 0.594; FDR 0.394; TPR 0.322

Train race gap RMS 0.17428635000271153
Train STD accuracy 0.009; balanced accuracy 0.006; FDR 0.010; TPR 0.019

--------------------------------------------------
Test AUC is 0.685202; balanced AUC is 0.685202
Test accuracy 0.647; balanced accuracy 0.637; FDR 0.317; TPR 0.465

Test sex accuracy 0.691; balanced accuracy 0.603; FDR 0.444; TPR 0.342

Test sex gap RMS 0.11445605681894894
Test race accuracy 0.659; balanced accuracy 0.595; FDR 0.381; TPR 0.311

Test race gap RMS 0.1885184471326055
Test STD accuracy 0.016; balanced accuracy 0.004; FDR 0.032; TPR 0.016

--------------------------------------------------
Real and fair distances (max/min/mean):
3.5222698649354762 0.011664183456998706 0.5333363149528623
4.407925e-06 2.242424e-06 3.6929944e-06
Counter success count is -1
Epoch 6000 train accuracy 0.644718; loss 0.641210; lambda is 0.000010
Epoch 6000 test accuracy 0.64678
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.645742; subspace 0.653637; adv 0.654741
Train AUC is 0.691712; balanced AUC is 0.691712
Train accuracy 0.645; balanced accuracy 0.635; FDR 0.323; TPR 0.468

Train sex accuracy 0.670; balanced accuracy 0.606; FDR 0.413; TPR 0.360

Train sex gap RMS 0.10053837897891706
Train race accuracy 0.653; balanced accuracy 0.594; FDR 0.394; TPR 0.322

Train race gap RMS 0.17428635000271153
Train STD accuracy 0.009; balanced accuracy 0.006; FDR 0.010; TPR 0.019

--------------------------------------------------
Test AUC is 0.696487; balanced AUC is 0.696487
Test accuracy 0.647; balanced accuracy 0.637; FDR 0.317; TPR 0.465

Test sex accuracy 0.691; balanced accuracy 0.603; FDR 0.444; TPR 0.342

Test sex gap RMS 0.11445605681894894
Test race accuracy 0.659; balanced accuracy 0.595; FDR 0.381; TPR 0.311

Test race gap RMS 0.1885184471326055
Test STD accuracy 0.016; balanced accuracy 0.004; FDR 0.032; TPR 0.016

--------------------------------------------------
Real and fair distances (max/min/mean):
3.231197009773301 0.007539476767614875 0.4757083624769508
4.4153903e-06 2.8091745e-06 3.6874667e-06
Counter success count is -1
Epoch 7000 train accuracy 0.652771; loss 0.638158; lambda is 0.000010
Epoch 7000 test accuracy 0.648674
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.635324; subspace 0.641314; adv 0.642500
Train AUC is 0.691973; balanced AUC is 0.691973
Train accuracy 0.653; balanced accuracy 0.646; FDR 0.336; TPR 0.530

Train sex accuracy 0.665; balanced accuracy 0.610; FDR 0.434; TPR 0.400

Train sex gap RMS 0.12091938559620609
Train race accuracy 0.658; balanced accuracy 0.610; FDR 0.400; TPR 0.385

Train race gap RMS 0.1804692499276589
Train STD accuracy 0.003; balanced accuracy 0.000; FDR 0.017; TPR 0.008

--------------------------------------------------
Test AUC is 0.698477; balanced AUC is 0.698477
Test accuracy 0.649; balanced accuracy 0.641; FDR 0.334; TPR 0.509

Test sex accuracy 0.691; balanced accuracy 0.610; FDR 0.449; TPR 0.370

Test sex gap RMS 0.137269291262702
Test race accuracy 0.666; balanced accuracy 0.611; FDR 0.384; TPR 0.365

Test race gap RMS 0.18944676423680964
Test STD accuracy 0.013; balanced accuracy 0.000; FDR 0.033; TPR 0.002

--------------------------------------------------
Real and fair distances (max/min/mean):
3.972886345318633 0.004324649500498721 0.47543930188017525
4.4096337e-06 2.3803204e-06 3.6543147e-06
Counter success count is -1
Epoch 8000 train accuracy 0.652771; loss 0.636061; lambda is 0.000010
Epoch 8000 test accuracy 0.648674
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.627981; subspace 0.635192; adv 0.636409
Train AUC is 0.692794; balanced AUC is 0.692794
Train accuracy 0.653; balanced accuracy 0.646; FDR 0.336; TPR 0.530

Train sex accuracy 0.665; balanced accuracy 0.610; FDR 0.434; TPR 0.400

Train sex gap RMS 0.12091938559620609
Train race accuracy 0.658; balanced accuracy 0.610; FDR 0.400; TPR 0.385

Train race gap RMS 0.1804692499276589
Train STD accuracy 0.003; balanced accuracy 0.000; FDR 0.017; TPR 0.008

--------------------------------------------------
Test AUC is 0.700302; balanced AUC is 0.700302
Test accuracy 0.649; balanced accuracy 0.641; FDR 0.334; TPR 0.509

Test sex accuracy 0.691; balanced accuracy 0.610; FDR 0.449; TPR 0.370

Test sex gap RMS 0.137269291262702
Test race accuracy 0.666; balanced accuracy 0.611; FDR 0.384; TPR 0.365

Test race gap RMS 0.18944676423680964
Test STD accuracy 0.013; balanced accuracy 0.000; FDR 0.033; TPR 0.002

--------------------------------------------------
Real and fair distances (max/min/mean):
3.9463787806629815 0.014500072959879802 0.7227220504622066
4.4357894e-06 2.7473686e-06 3.6424217e-06
Counter success count is -1
Epoch 9000 train accuracy 0.652771; loss 0.634398; lambda is 0.000010
Epoch 9000 test accuracy 0.648674
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.643372; subspace 0.651446; adv 0.652758
Train AUC is 0.695165; balanced AUC is 0.695165
Train accuracy 0.653; balanced accuracy 0.646; FDR 0.336; TPR 0.530

Train sex accuracy 0.665; balanced accuracy 0.610; FDR 0.434; TPR 0.400

Train sex gap RMS 0.12091938559620609
Train race accuracy 0.658; balanced accuracy 0.610; FDR 0.400; TPR 0.385

Train race gap RMS 0.1804692499276589
Train STD accuracy 0.003; balanced accuracy 0.000; FDR 0.017; TPR 0.008

--------------------------------------------------
Test AUC is 0.706752; balanced AUC is 0.706752
Test accuracy 0.649; balanced accuracy 0.641; FDR 0.334; TPR 0.509

Test sex accuracy 0.691; balanced accuracy 0.610; FDR 0.449; TPR 0.370

Test sex gap RMS 0.137269291262702
Test race accuracy 0.666; balanced accuracy 0.611; FDR 0.384; TPR 0.365

Test race gap RMS 0.18944676423680964
Test STD accuracy 0.013; balanced accuracy 0.000; FDR 0.033; TPR 0.002

--------------------------------------------------
Real and fair distances (max/min/mean):
2.9781033116371853 0.018980791313699674 0.5280767081510864
4.4372246e-06 2.8018287e-06 3.8093792e-06
Counter success count is -1
Epoch 10000 train accuracy 0.652771; loss 0.633854; lambda is 0.000010
Epoch 10000 test accuracy 0.648674
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.619530; subspace 0.624042; adv 0.625245
Train AUC is 0.695169; balanced AUC is 0.695169
Train accuracy 0.653; balanced accuracy 0.646; FDR 0.336; TPR 0.530

Train sex accuracy 0.665; balanced accuracy 0.610; FDR 0.434; TPR 0.400

Train sex gap RMS 0.12091938559620609
Train race accuracy 0.658; balanced accuracy 0.610; FDR 0.400; TPR 0.385

Train race gap RMS 0.1804692499276589
Train STD accuracy 0.003; balanced accuracy 0.000; FDR 0.017; TPR 0.008

--------------------------------------------------
Test AUC is 0.708102; balanced AUC is 0.708102
Test accuracy 0.649; balanced accuracy 0.641; FDR 0.334; TPR 0.509

Test sex accuracy 0.691; balanced accuracy 0.610; FDR 0.449; TPR 0.370

Test sex gap RMS 0.137269291262702
Test race accuracy 0.666; balanced accuracy 0.611; FDR 0.384; TPR 0.365

Test race gap RMS 0.18944676423680964
Test STD accuracy 0.013; balanced accuracy 0.000; FDR 0.033; TPR 0.002

--------------------------------------------------
Real and fair distances (max/min/mean):
2.957707412777661 0.006327241554662445 0.45227534629202465
4.405583e-06 1.7098943e-06 3.6498286e-06
Counter success count is -1
Epoch 11000 train accuracy 0.652771; loss 0.633216; lambda is 0.000010
Epoch 11000 test accuracy 0.648674
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.619914; subspace 0.624715; adv 0.625962
Train AUC is 0.694715; balanced AUC is 0.694715
Train accuracy 0.653; balanced accuracy 0.646; FDR 0.336; TPR 0.530

Train sex accuracy 0.665; balanced accuracy 0.610; FDR 0.434; TPR 0.400

Train sex gap RMS 0.12091938559620609
Train race accuracy 0.658; balanced accuracy 0.610; FDR 0.400; TPR 0.385

Train race gap RMS 0.1804692499276589
Train STD accuracy 0.003; balanced accuracy 0.000; FDR 0.017; TPR 0.008

--------------------------------------------------
Test AUC is 0.707008; balanced AUC is 0.707008
Test accuracy 0.649; balanced accuracy 0.641; FDR 0.334; TPR 0.509

Test sex accuracy 0.691; balanced accuracy 0.610; FDR 0.449; TPR 0.370

Test sex gap RMS 0.137269291262702
Test race accuracy 0.666; balanced accuracy 0.611; FDR 0.384; TPR 0.365

Test race gap RMS 0.18944676423680964
Test STD accuracy 0.013; balanced accuracy 0.000; FDR 0.033; TPR 0.002

--------------------------------------------------
Real and fair distances (max/min/mean):
2.5593353670156107 0.0008895995994747247 0.3904117747660443
4.4339213e-06 2.2529516e-06 3.6974309e-06
Counter success count is -1
Epoch 12000 train accuracy 0.650876; loss 0.632530; lambda is 0.000010
Epoch 12000 test accuracy 0.648674
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.627056; subspace 0.629285; adv 0.630540
Train AUC is 0.695504; balanced AUC is 0.695504
Train accuracy 0.651; balanced accuracy 0.645; FDR 0.346; TPR 0.548

Train sex accuracy 0.662; balanced accuracy 0.610; FDR 0.441; TPR 0.410

Train sex gap RMS 0.13110114862341637
Train race accuracy 0.654; balanced accuracy 0.609; FDR 0.414; TPR 0.402

Train race gap RMS 0.18302107082276553
Train STD accuracy 0.004; balanced accuracy 0.000; FDR 0.013; TPR 0.004

--------------------------------------------------
Test AUC is 0.711583; balanced AUC is 0.711583
Test accuracy 0.649; balanced accuracy 0.642; FDR 0.345; TPR 0.535

Test sex accuracy 0.695; balanced accuracy 0.624; FDR 0.444; TPR 0.411

Test sex gap RMS 0.1326734726655919
Test race accuracy 0.664; balanced accuracy 0.614; FDR 0.400; TPR 0.395

Test race gap RMS 0.18663059719510094
Test STD accuracy 0.016; balanced accuracy 0.005; FDR 0.022; TPR 0.008

--------------------------------------------------
Real and fair distances (max/min/mean):
3.485448755689189 0.014653910336208092 0.48814122187615583
4.4402686e-06 2.226982e-06 3.7353993e-06
Counter success count is -1
Epoch 13000 train accuracy 0.650876; loss 0.631806; lambda is 0.000010
Epoch 13000 test accuracy 0.648674
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.619301; subspace 0.623821; adv 0.625164
Train AUC is 0.701357; balanced AUC is 0.701357
Train accuracy 0.651; balanced accuracy 0.645; FDR 0.346; TPR 0.548

Train sex accuracy 0.662; balanced accuracy 0.610; FDR 0.441; TPR 0.410

Train sex gap RMS 0.13110114862341637
Train race accuracy 0.654; balanced accuracy 0.609; FDR 0.414; TPR 0.402

Train race gap RMS 0.18302107082276553
Train STD accuracy 0.004; balanced accuracy 0.000; FDR 0.013; TPR 0.004

--------------------------------------------------
Test AUC is 0.712590; balanced AUC is 0.712590
Test accuracy 0.649; balanced accuracy 0.642; FDR 0.345; TPR 0.535

Test sex accuracy 0.695; balanced accuracy 0.624; FDR 0.444; TPR 0.411

Test sex gap RMS 0.1326734726655919
Test race accuracy 0.664; balanced accuracy 0.614; FDR 0.400; TPR 0.395

Test race gap RMS 0.18663059719510094
Test STD accuracy 0.016; balanced accuracy 0.005; FDR 0.022; TPR 0.008

--------------------------------------------------
Real and fair distances (max/min/mean):
3.2680821889019116 0.0037700912876698083 0.40922312310917863
4.4399267e-06 2.7520914e-06 3.7516925e-06
Counter success count is -1
Epoch 14000 train accuracy 0.663666; loss 0.631255; lambda is 0.000010
Epoch 14000 test accuracy 0.660038
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.633834; subspace 0.635803; adv 0.637112
Train AUC is 0.700496; balanced AUC is 0.700496
Train accuracy 0.664; balanced accuracy 0.659; FDR 0.337; TPR 0.580

Train sex accuracy 0.667; balanced accuracy 0.617; FDR 0.434; TPR 0.427

Train sex gap RMS 0.14309192972661272
Train race accuracy 0.659; balanced accuracy 0.617; FDR 0.409; TPR 0.421

Train race gap RMS 0.1931605286741192
Train STD accuracy 0.004; balanced accuracy 0.000; FDR 0.012; TPR 0.003

--------------------------------------------------
Test AUC is 0.711532; balanced AUC is 0.711532
Test accuracy 0.660; balanced accuracy 0.655; FDR 0.338; TPR 0.567

Test sex accuracy 0.705; balanced accuracy 0.638; FDR 0.429; TPR 0.438

Test sex gap RMS 0.140115551493922
Test race accuracy 0.671; balanced accuracy 0.623; FDR 0.389; TPR 0.413

Test race gap RMS 0.20450837317637421
Test STD accuracy 0.017; balanced accuracy 0.007; FDR 0.020; TPR 0.013

--------------------------------------------------
Real and fair distances (max/min/mean):
2.642156880367179 0.02719358523577828 0.47491388201587426
4.4402077e-06 2.6966584e-06 3.8169132e-06
Counter success count is -1
Epoch 15000 train accuracy 0.665088; loss 0.630626; lambda is 0.000010
Epoch 15000 test accuracy 0.660985
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.636769; subspace 0.638568; adv 0.639894
Train AUC is 0.700152; balanced AUC is 0.700152
Train accuracy 0.665; balanced accuracy 0.661; FDR 0.336; TPR 0.584

Train sex accuracy 0.667; balanced accuracy 0.617; FDR 0.434; TPR 0.427

Train sex gap RMS 0.14590098232507534
Train race accuracy 0.663; balanced accuracy 0.622; FDR 0.404; TPR 0.432

Train race gap RMS 0.18629057661636078
Train STD accuracy 0.002; balanced accuracy 0.002; FDR 0.015; TPR 0.003

--------------------------------------------------
Test AUC is 0.711392; balanced AUC is 0.711392
Test accuracy 0.661; balanced accuracy 0.656; FDR 0.337; TPR 0.569

Test sex accuracy 0.705; balanced accuracy 0.638; FDR 0.429; TPR 0.438

Test sex gap RMS 0.14139274934939228
Test race accuracy 0.673; balanced accuracy 0.626; FDR 0.386; TPR 0.419

Test race gap RMS 0.2011235922640899
Test STD accuracy 0.016; balanced accuracy 0.006; FDR 0.021; TPR 0.010

--------------------------------------------------
Real and fair distances (max/min/mean):
2.099116792082419 0.02321099266981992 0.3996546244102842
4.4402077e-06 2.6966584e-06 3.8169132e-06
Counter success count is -1
Epoch 15999 train accuracy 0.665798; loss 0.630161; lambda is 0.000010
Epoch 15999 test accuracy 0.661932
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.631807; subspace 0.633852; adv 0.635215
Train AUC is 0.702286; balanced AUC is 0.702286
Train accuracy 0.666; balanced accuracy 0.661; FDR 0.337; TPR 0.588

Train sex accuracy 0.670; balanced accuracy 0.622; FDR 0.431; TPR 0.440

Train sex gap RMS 0.13828994401035322
Train race accuracy 0.663; balanced accuracy 0.623; FDR 0.404; TPR 0.435

Train race gap RMS 0.18800936857917047
Train STD accuracy 0.003; balanced accuracy 0.000; FDR 0.014; TPR 0.002

--------------------------------------------------
Test AUC is 0.711064; balanced AUC is 0.711064
Test accuracy 0.662; balanced accuracy 0.657; FDR 0.337; TPR 0.573

Test sex accuracy 0.700; balanced accuracy 0.634; FDR 0.439; TPR 0.438

Test sex gap RMS 0.14099678142379596
Test race accuracy 0.673; balanced accuracy 0.626; FDR 0.386; TPR 0.419

Test race gap RMS 0.20598642086782246
Test STD accuracy 0.014; balanced accuracy 0.004; FDR 0.026; TPR 0.010

--------------------------------------------------
/home/smaity/project/iftest/compas/sensr/train_clp_adult.py:47: RuntimeWarning: Mean of empty slice.
  fdr = (y_true[idx_pred_1]==0).mean()
/home/smaity/.local/lib/python3.6/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/home/smaity/project/iftest/compas/sensr/train_clp_adult.py:47: RuntimeWarning: Mean of empty slice.
  fdr = (y_true[idx_pred_1]==0).mean()
/home/smaity/.local/lib/python3.6/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)

Final train accuracy 0.665798
Final test accuracy 0.661932
Final lambda 0.000010
Gender:
Accuracy is 0.661932
Balanced accuracy is 0.657024
Gap RMS is 0.14099678142379596
Mean absolute gap is 0.13976802876771566
Max gap is 0.15834194882398556
Average odds difference is 0.139768
Equal opportunity difference is 0.158342
Statistical parity difference is 0.187081

Race:
Accuracy is 0.661932
Balanced accuracy is 0.657024
Gap RMS is 0.20598642086782243
Mean absolute gap is 0.20402984477885522
Max gap is 0.23235347486844493
Average odds difference is 0.204030
Equal opportunity difference is 0.232353
Statistical parity difference is 0.241099
